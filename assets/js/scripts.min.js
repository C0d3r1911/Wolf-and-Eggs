var Wolf=function(){var t=function(t){this.element=t};return t.prototype.changeElement=function(t,e){this.element.setAttribute("src",e),this.element.removeAttribute("class"),this.element.setAttribute("class",t)},t.prototype.leftTop=function(){this.changeElement("left-top","assets/img/left-top.png")},t.prototype.leftBottom=function(){this.changeElement("left-bottom","assets/img/left-bottom.png")},t.prototype.rightTop=function(){this.changeElement("right-top","assets/img/right-top.png")},t.prototype.rightBottom=function(){this.changeElement("right-bottom","assets/img/right-bottom.png")},t}(),Egg=function(){var t=function(t,e,i,o){this.containers=t,this.eggLocation=28,this.birdLocation=3,this.wolf=e,this.fail=i,this.success=o,this.startMove(),this.isHaveBird=this.withOrWithoutBird(),this.initialRoost=this.getContainer(this.getRandomRoost()),this.singleEgg=this.createElement(this.initialRoost.container)};return t.roost={LEFT_TOP:1,LEFT_BOTTOM:2,RIGHT_TOP:3,RIGHT_BOTTOM:4},t.prototype.getRandomRoost=function(){return Math.floor(4*Math.random()+1)},t.prototype.getContainer=function(e){var i;switch(e){case t.roost.LEFT_TOP:i={container:this.containers["left-top"],roostSide:"left",roostName:"left-top"};break;case t.roost.LEFT_BOTTOM:i={container:this.containers["left-bottom"],roostSide:"left",roostName:"left-bottom"};break;case t.roost.RIGHT_TOP:i={container:this.containers["right-top"],roostSide:"right",roostName:"right-top"};break;case t.roost.RIGHT_BOTTOM:i={container:this.containers["right-bottom"],roostSide:"right",roostName:"right-bottom"}}return i},t.prototype.createElement=function(t){var e=document.createElement("img");e.setAttribute("src","assets/img/egg.png");var i=document.createElement("div");return i.appendChild(e),t.appendChild(i),i},t.prototype.startMove=function(){this.timer=setInterval(this.moveEgg.bind(this),580)},t.prototype.moveEgg=function(){"left"===this.initialRoost.roostSide?this.moveLeftEgg():this.moveRightEgg(),103===this.eggLocation&&this.wolf.classList[0]===this.initialRoost.roostName&&(this.success(1),this.removeEgg()),this.eggLocation>103&&(this.singleEgg.firstChild&&this.singleEgg.removeChild(this.singleEgg.firstChild),this.singleEgg.style.top="230px",this.isBroken(),this.isHaveBird===!0?(118===this.eggLocation&&this.fail(.5),this.birdLocation>120&&this.removeEgg()):(118===this.eggLocation&&this.fail(1),this.birdLocation>23&&this.removeEgg()))},t.prototype.moveLeftEgg=function(){this.eggLocation+=15,this.eggLocation<103&&(this.singleEgg.style.left=this.eggLocation+"px",this.singleEgg.setAttribute("class","egg left-egg-"+this.eggLocation))},t.prototype.moveRightEgg=function(){this.eggLocation+=15,this.eggLocation<103&&(this.singleEgg.style.right=this.eggLocation+"px",this.singleEgg.setAttribute("class","egg right-egg-"+this.eggLocation))},t.prototype.withOrWithoutBird=function(){return[!0,!1,!0][Math.round(2*Math.random())]},t.prototype.isBroken=function(){this.eggLocation>103&&(this.moveBirdOnLeft(),this.moveBirdOnRight(),this.birdLocation+=20)},t.prototype.moveBirdOnLeft=function(){"left"===this.initialRoost.roostSide&&(this.singleEgg.setAttribute("class","left-egg-bird-"+this.birdLocation),this.singleEgg.style.left=100-this.birdLocation+"px")},t.prototype.moveBirdOnRight=function(){"right"===this.initialRoost.roostSide&&(this.singleEgg.setAttribute("class","right-egg-bird-"+this.birdLocation),this.singleEgg.style.right=100-this.birdLocation+"px")},t.prototype.removeEgg=function(){this.singleEgg.parentNode&&this.singleEgg.parentNode.removeChild(this.singleEgg),clearInterval(this.timer)},t}(),App=function(t,e){var i=function(){this.eggs=[],this.elements={},this.wolf=null,this.points=0,this.lostPoints=0,this.isPlayingNow=!1,this.init()};return i.prototype.init=function(){this.storeElements(),this.changeWolfPosition(),this.addMouseListeners()},i.prototype.storeElements=function(){this.elements={roosts:{"left-top":document.getElementById("roost-1"),"left-bottom":document.getElementById("roost-2"),"right-top":document.getElementById("roost-3"),"right-bottom":document.getElementById("roost-4")},wolf:document.getElementById("wolf"),rabbit:document.getElementById("rabbit"),buttons:{leftTop:document.getElementById("button-left-top"),leftBottom:document.getElementById("button-left-bottom"),rightTop:document.getElementById("button-right-top"),rightBottom:document.getElementById("button-right-bottom"),start:document.getElementById("button-start")},points:{plus:document.getElementById("points"),lost:document.getElementById("lost-points")}}},i.prototype.changeWolfPosition=function(){this.wolf=new e(this.elements.wolf)},i.prototype.addMouseListeners=function(){this.elements.buttons.leftTop.addEventListener("click",this.wolf.leftTop.bind(this.wolf)),this.elements.buttons.leftBottom.addEventListener("click",this.wolf.leftBottom.bind(this.wolf)),this.elements.buttons.rightTop.addEventListener("click",this.wolf.rightTop.bind(this.wolf)),this.elements.buttons.rightBottom.addEventListener("click",this.wolf.rightBottom.bind(this.wolf)),this.elements.buttons.start.addEventListener("click",this.start.bind(this))},i.prototype.showGameElements=function(){this.elements.wolf.classList.remove("hide"),this.elements.points.plus.classList.remove("hide")},i.prototype.start=function(){this.isPlayingNow||(this.isPlayingNow=!0,this.resetResults(),this.showGameElements(),this.play(),this.elements.buttons.start.setAttribute("value","Playing"))},i.prototype.play=function(){console.log(this.updateFrequency(this.eggs.length)),this.createNewEgg(),this.createEgg=setTimeout(this.play.bind(this),this.updateFrequency(this.eggs.length)),this.startFromBeginning()},i.prototype.playAgain=function(){this.isPlayingNow=!1,this.elements.buttons.start.setAttribute("value","Play Again")},i.prototype.startFromBeginning=function(){this.eggs.length>999&&(this.eggs.length=0,this.points=0,this.elements.points.plus.textContent=0)},i.prototype.createNewEgg=function(){this.newEgg=new t(this.elements.roosts,this.elements.wolf,this.onFail.bind(this),this.onSuccess.bind(this)),this.eggs.push(this.newEgg)},i.prototype.updateFrequency=function(t){var e=3500;return t>10&&t<25?e=2500:t>=25&&t<50?e=1500:t>=50&&t<75?e=1200:t>=75&&(e=1e3),this.showRabbitwhenFrequencyChanged(t),e},i.prototype.showRabbitwhenFrequencyChanged=function(t){10===t||25===t||50===t||75===t?this.elements.rabbit.classList.add("rabbit"):this.elements.rabbit.classList.remove("rabbit")},i.prototype.onFail=function(t){this.lostPoints=this.lostPoints+t,this.showLostPoints(this.elements.points.lost),this.finishGame()},i.prototype.onSuccess=function(t){this.points=this.points+t,this.elements.points.plus.textContent=this.points},i.prototype.showLostPoints=function(t){function e(t){var e=document.createElement("img");e.setAttribute("src","assets/img/minuspoint.png"),i.appendChild(e),e.setAttribute("class",t)}for(var i=t,o=1;o<4;o++)if(this.lostPoints===o||3.5===this.lostPoints){this.elements.points.lost.textContent="";for(var s=0;s<o;s++)e("")}.5===this.lostPoints&&e("animateEgg"),1.5===this.lostPoints&&(this.elements.points.lost.textContent="",e(""),e("animateEgg")),2.5===this.lostPoints&&(this.elements.points.lost.textContent="",e(""),e(""),e("animateEgg"))},i.prototype.finishGame=function(){function t(t){clearTimeout(t.timer)}this.lostPoints>=3&&(clearTimeout(this.createEgg),this.eggs.forEach(t),this.playAgain())},i.prototype.resetResults=function(){function t(t){t.removeEgg()}this.eggs.length>0&&(this.points=0,this.lostPoints=0,this.elements.points.plus.textContent=0,this.elements.points.lost.textContent="",this.eggs.forEach(t),this.eggs.length=0)},new i}(Egg,Wolf);!function(){function t(){h(":focus{outline:0}::-moz-focus-inner{border:0;}")}function e(){h("")}var i=document,o=i.createElement("STYLE"),s="addEventListener"in i,n=function(t,e){s?i.addEventListener(t,e):i.attachEvent("on"+t,e)},h=function(t){o.styleSheet?o.styleSheet.cssText=t:o.innerHTML=t};i.getElementsByTagName("HEAD")[0].appendChild(o),n("mousedown",t),n("keydown",e)}();